SELECT a.Panel_Make, IF(SUBSTRING_INDEX(b.alarm,'',-1)(CASE WHEN a.Panel_Make = 'RASS' THEN (SELECT SensorName FROM rass WHERE ZONE=b.zone AND SCODE=b.alarm) WHEN a.Panel_Make ='SMART -I' THEN (SELECT SensorName FROM smarti_boi WHERE ZONE=b.zone AND SCODE=b.alarm) ELSE '-' END) AS SensorName, a.zone as zon,a.City,a.State,b.id,b.panelid,b.createtime,b.receivedtime,b.comment,b.zone,b.alarm,b.closedBy,b.closedtime FROM `sites` a,`alerts` b WHERE (a.OldPanelID=b.panelid or a.NewPanelID=b.panelid) AND a.Customer LIKE 'Euronet%' AND (a.Panel_Make='RASS' or a.Panel_Make='SMART -I') AND ((b.alarm IN ('AT','AR') AND b.zone IN ('029','030')) OR (b.alarm IN ('BA','BR') AND b.zone IN ('001','002'))) AND CAST(b.receivedtime AS DATE)>= '2022-04-07' and CAST(b.receivedtime AS DATE)<='2022-04-08'

(SELECT SensorName FROM rass WHERE ZONE=b.zone AND SCODE LIKE 'A%') WHEN a.Panel_Make ='SMART -I' THEN (SELECT SensorName FROM smarti_boi WHERE ZONE=b.zone AND SCODE LIKE 'B%') ELSE '-' END),' Restoral'),(CASE WHEN a.Panel_Make = 'RASS' THEN (SELECT SensorName FROM rass WHERE ZONE=b.zone AND SCODE=b.alarm) WHEN a.Panel_Make ='SMART -I' THEN (SELECT SensorName FROM smarti_boi WHERE ZONE=b.zone AND SCODE=b.alarm) ELSE '-' END)) AS SensorName, a.zone as zon,a.City,a.State,b.id,b.panelid,b.createtime,b.receivedtime,b.comment,b.zone,b.alarm,b.closedBy,b.closedtime FROM `sites` a,`alerts` b WHERE (a.OldPanelID=b.panelid or a.NewPanelID=b.panelid) AND a.Customer LIKE 'Euronet%' AND (a.Panel_Make='RASS' or a.Panel_Make='SMART -I') AND ((b.alarm IN ('AT','AR') AND b.zone IN ('029','030')) OR (b.alarm IN ('BA','BR') AND b.zone IN ('001','002'))) AND CAST(b.receivedtime AS DATE)>= '2022-04-07' and CAST(b.receivedtime AS DATE)<='2022-04-08'